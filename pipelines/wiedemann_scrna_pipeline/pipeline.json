{
  "id": "wiedemann_scrna_pipeline",
  "name": "Wiedemann single cell RNA-Seq pipeline",
  "description": "<p>This pipeline processes single cell RNA-Seq data. For data obtained with fixed cell protocols it is recommended to skip the ambient RNA removal step by using the according step variable below.</p><p><b>Input specifications</b><br />Each sample needs to be provided as a separate folder containing the filtered and raw H5 count matrices that are output by <a href=\"https://www.10xgenomics.com/support/software/cell-ranger/analysis/outputs/cr-outputs-overview\">CellRanger</a>. The files need to end with <code>filtered_feature_bc_matrix.h5</code> and <code>raw_feature_bc_matrix.h5</code> respectively. Additionally, a <code>sample_information.csv</code> (comma delimeted and UTF-8 encoded) at the directory root is needed that is used for sample naming and replicate detection. An example can be downloaded <a href=\"/api/pipelines/attachments/wiedemann_scrna_pipeline/sample_information.csv\">here</a>.</p><p><b>System requirements</b><br />64 GB of RAM are recommended for pipeline execution.</p>",
  "steps": [
    {
      "id": "preprocessing",
      "name": "Preprocessing",
      "description": "<p>Performs an initial quality control of sequenced reads and removes low quality reads.</p><p><b>Output</b><br />For each sample the preprocessed <code>filtered_feature_bc_matrix.h5ad</code> file is generated. Metrics are summed up in the <code>metrics.csv</code> file. Additionally the following plots are generated per sample:<ul><li><code>histo_raw_total_counts.svg</code>: historgram of the raw counts before filtering low quality cells</li><li><code>violin_raw_mitochondiral_counts.svg</code>: violin plot of the percentage of mitochondrial genes before filtering low quality cells</li><li><code>scatter_raw_number_of_genes.svg</code>: scatter plot of total genes, total counts and percentage of mitochondrial counts per cell before filtering low quality cells</li><li><code>scatter_filtered_number_of_genes.svg</code>: scatter plot of total genes, total counts and percentage of mitochondrial counts per cell after filtering low quality cells</li></ul></p><p><b>References</b><ol><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "preprocessing",
      "dependencies": [],
      "variables": []
    },
    {
      "id": "ambient_rna_removal",
      "name": "Ambient RNA removal",
      "description": "<p>Detects and removes ambient RNA and removes non-informative genes.</p><p><b>References</b><ol><li>Young, M.D., Behjati, S. (2020). SoupX removes ambient RNA contamination from droplet-based single-cell RNA sequencing data, GigaScience, Volume 9, Issue 12, December 2020, giaa151bioRxiv, 303727, <a href=\"https://doi.org/10.1093/gigascience/giaa151\">https://doi.org/10.1093/gigascience/giaa151</a></li><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "ambient_rna",
      "dependencies": ["preprocessing"],
      "variables": [
        {
          "id": "SKIP",
          "name": "Skip ambient RNA removal",
          "description": "Skip adjusting the feature counts for ambient RNA / background. This might be desirable for pre-filtered samples or fixed scRNA-Seq data, where the low ambient RNA content leads to bad inference of the contamination fraction. Non-informative genes are still filtered out.",
          "category": {
            "tag": "Boolean"
          }
        }
      ]
    },
    {
      "id": "doublet_detection",
      "name": "Doublet detection",
      "description": "<p>Detects and marks cell doublets.</p><p><b>References</b><ol><li>Germain P, Lun A, Garcia Meixide C, Macnair W, Robinson M (2022). Doublet identification in single-cell sequencing data using scDblFinder. f1000research. <a href=\"https://doi.org/10.12688/f1000research.73600.2\">doi:10.12688/f1000research.73600.2</a></li><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "doublet_detection",
      "dependencies": ["ambient_rna_removal"],
      "variables": []
    },
    {
      "id": "doublet_removal",
      "name": "Doublet removal",
      "description": "<p>Removes detected doublets. Doublets are not removed from unbatched data, which is used downstream for QC purposes.</p><p><b>References</b><ol><li>Germain P, Lun A, Garcia Meixide C, Macnair W, Robinson M (2022). Doublet identification in single-cell sequencing data using scDblFinder. f1000research. <a href=\"https://doi.org/10.12688/f1000research.73600.2\">doi:10.12688/f1000research.73600.2</a></li><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "doublet_removal",
      "dependencies": ["doublet_detection"],
      "variables": []
    },
    {
      "id": "integration",
      "name": "Integration",
      "description": "<p>Integrates different samples of the same type with each other.</p><p><b>References</b><ol><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "integration",
      "dependencies": ["doublet_removal"],
      "variables": []
    },
    {
      "id": "normalisation",
      "name": "Normalisation",
      "description": "<p>Normalises batched and unbatched data using different methods for downstream analysis.</p><p><b>References</b><ol><li>RA Dorfman. A note on the !d-method for finding variance formulae. Biometric Bulletin, 1938.</li><li>Germain, PL., Sonrel, A. & Robinson, M.D. pipeComp, a general framework for the evaluation of computational pipelines, reveals performant single cell RNA-seq preprocessing tools. Genome Biol 21, 227 (2020). <a href=\"https://doi.org/10.1186/s13059-020-02136-7\">https://doi.org/10.1186/s13059-020-02136-7</a></li><li>Lun ATL, McCarthy DJ, Marioni JC (2016). A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor. F1000Res., 5, 2122. <a href=\"doi:10.12688/f1000research.9501.2\">doi:10.12688/f1000research.9501.2</a></li><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "normalisation",
      "dependencies": ["doublet_detection", "integration"],
      "variables": []
    },
    {
      "id": "clustering_qc_batched",
      "name": "Batched QC clustering",
      "description": "<p>Selects relevant features for downstream analysis.</p><p><b>References</b><ol><li>Street K, Townes F, Risso D, Hicks S (2023). scry: Small-Count Analysis Methods for High-Dimensional Data. doi:10.18129/B9.bioc.scry, R package version 1.14.0, <a href=\"https://bioconductor.org/packages/scry\">https://bioconductor.org/packages/scry</a></li><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "clustering_qc_batched",
      "dependencies": ["normalisation"],
      "variables": []
    },
    {
      "id": "feature_selection",
      "name": "Feature selection",
      "description": "<p>Selects relevant features for downstream analysis.</p><p><b>References</b><ol><li>Street K, Townes F, Risso D, Hicks S (2023). scry: Small-Count Analysis Methods for High-Dimensional Data. doi:10.18129/B9.bioc.scry, R package version 1.14.0, <a href=\"https://bioconductor.org/packages/scry\">https://bioconductor.org/packages/scry</a></li><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "feature_selection",
      "dependencies": ["normalisation"],
      "variables": []
    },
    {
      "id": "clustering_qc_unbatched",
      "name": "Unbatched QC clustering",
      "description": "<p>Clusters unbatched samples for quality control.</p><p><b>References</b><ol><li>Heumos, L., Schaar, A.C., Lance, C. et al. Best practices for single-cell analysis across modalities. Nat Rev Genet (2023). <a href=\"https://doi.org/10.1038/s41576-023-00586-w\">https://doi.org/10.1038/s41576-023-00586-w</a></li></ol></p>",
      "container": "clustering_qc_unbatched",
      "dependencies": ["feature_selection"],
      "variables": []
    }
  ]
}
